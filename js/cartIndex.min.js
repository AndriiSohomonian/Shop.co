import{c as o,u as y}from"./app.min.js";import"./quantity.min.js";JSON.parse(localStorage.getItem("cart")),window.addEventListener("storage",r=>{if(r.key==="cart"){const t=JSON.parse(localStorage.getItem("cart"))||[];g(t)}});class v{constructor(t){this.title=t.title,this.image=t.image,this.price=t.price,this.color=t.color,this.size=t.size,this.quantity=t.quantity}setImage(t){const e=o("div","cart__image"),n=o("img","cart__image-item");return n.src=this.image,n.alt=this.title,e.append(n),e}setAbout(){const t=o("div","item-content__about"),e=o("div","item-content__title");e.textContent=this.title;const n=o("div","item-content__size-color");n.textContent="Size: ";const c=o("span","item-content__size-span");c.textContent=this.size,n.append(c);const a=o("div","item-content__size-color");a.textContent="Color: ";const p=o("span","item-content__color-span");return p.textContent=this.color,a.append(p),t.append(e),t.append(n),t.append(a),t}setPrice(){const t=o("div","cards__price");if(this.price.sale===0)t.textContent="$"+this.price.startPrice;else{t.textContent="$"+Math.ceil(this.price.startPrice-this.price.startPrice*this.price.sale/100);const e=o("span","cards__prics-discount");e.textContent="$"+this.price.startPrice;const n=o("span");n.textContent="-"+this.price.sale+"%",e.append(n),t.append(e)}return t}removeItem(t){const n=(JSON.parse(localStorage.getItem("cart"))||[]).filter(a=>`${a.title}_${a.color}_${a.size}`!==t);localStorage.setItem("cart",JSON.stringify(n));const c=document.querySelector(`[data-item-key="${t}"]`);c&&c.remove(),g(n),y()}setContent(t){const e=o("div","cart__item-content-wrapper"),n=o("div",["cart__item-content","item-content"]);n.append(this.setAbout()),n.append(this.setPrice());const c=o("div",["cart__item-content","item-content"]),a=o("div","quantity");a.setAttribute("data-fls-dynamic",".item-content__about, 768, 3, .cart__item-content-wrapper"),a.setAttribute("data-fls-quantity","");const p=o("button",["quantity__button","quantity__button--minus"]);p.type="button";const u=o("button",["quantity__button","quantity__button--plus"]);u.type="button";const m=o("div","quantity__input"),i=o("input");i.type="text",i.name="form[]",i.value=this.quantity||1,i.autocomplete="off",m.append(i),a.append(p,m,u),p.addEventListener("click",()=>{let s=parseInt(i.value);s>1&&(i.value=--s,C(t,s),y())}),u.addEventListener("click",()=>{let s=parseInt(i.value);i.value=++s,C(t,s),y()});const d=o("button",["item-content","--icon-can"]);return d.addEventListener("click",()=>{this.removeItem(t),_(JSON.parse(localStorage.getItem("cart"))||[])}),c.append(d),c.append(a),e.append(n),e.append(c),e}setPage(){const t=document.querySelector(".cart__wrapper-items"),e=o("div","cart__item"),n=`${this.title}_${this.color}_${this.size}`;e.dataset.itemKey=n,e.append(this.setImage()),e.append(this.setContent(n)),t.append(e)}}let l=0;function C(r,t){let e=JSON.parse(localStorage.getItem("cart"))||[];e=e.map(n=>(`${n.title}_${n.color}_${n.size}`===r&&(n.quantity=t),n)),localStorage.setItem("cart",JSON.stringify(e)),_(e)}function _(r){let t=0,e=0;const n=15;r.forEach(i=>{const d=i.quantity||1,s=i.price.startPrice,S=i.price.sale||0,h=Math.ceil(s-s*S/100);t+=h*d,e+=s*d-h*d});const c=Math.ceil(t*l),a=r.length>0,p=a?t-c+n:0;document.getElementById("subtotal").textContent=`$${a?t:0}`,document.getElementById("discount").textContent=`-$${a?e+c:0}`,document.getElementById("total").textContent=`$${p}`;const u=document.getElementById("discount-percent");u&&(u.textContent=l>0&&a?`(-${l*100}% \u0437 \u043F\u0440\u043E\u043C\u043E\u043A\u043E\u0434\u0443)`:"(-0%)");const m=document.querySelector(".summary__item-discount-span");m&&(m.textContent=l>0&&a?`(-${l*100}%)`:"(-0%)")}document.getElementById("apply-promo").addEventListener("click",()=>{document.getElementById("promo-code").value.trim().toLowerCase()==="promo"?l=.2:l=0;const t=JSON.parse(localStorage.getItem("cart"))||[];_(t)});function g(r){const t=document.querySelector(".cart__wrapper-items");if(t.innerHTML="",r.length===0){const e=document.createElement("div");e.textContent="Your cart is empty",e.style.padding="40px",e.style.fontSize="20px",e.style.textAlign="center",e.style.color="#777",t.appendChild(e)}else r.forEach(e=>{new v(e).setPage()});_(r)}const I=JSON.parse(localStorage.getItem("cart"))||[];g(I);
